(def optional (parser)
  (fn (p)
    (iflet (p2 r) (parser p)
      (return p2 r)
      (return p nil))))
